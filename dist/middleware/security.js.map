{"version":3,"file":"security.js","sourceRoot":"","sources":["../../src/middleware/security.ts"],"names":[],"mappings":"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"}